<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.js"></script>
    <style>
        table {
            width: 800px;
            /* height: 100px; */
            text-align: center;
            border-collapse: collapse;
        }

        th,
        td {
            border: 1px solid #666;
            padding: 5px 15px;
        }

        td span {
            color: red;
        }
    </style>
</head>

<body>
    <div class="booklist">
        <input type="text"><button class="search">Search</button>
        <input type="text" class='name'><button class="search-name">按name搜索</button>
        <table>
            <thead>
                <tr>
                    <th>bookName</th>
                    <th>author</th>
                    <th>date</th>
                    <th>inventory</th>
                </tr>
            </thead>
            <tbody>

            </tbody>
        </table>
    </div>
    <script>
        var books = [
            {
                bookName: "Dolores voluptatibus consequuntur ut ad eum",
                author: "Rebeca Cruickshank",
                date: "2020-08-24 01:15:11",
                inventory: 100
            },
            {
                bookName: "Ipsa id deleniti eum sit nulla",
                author: "Violet Prohaska",
                date: "2019-12-10 02:11:18",
                inventory: 150
            },
            {
                bookName: "Ratione est corporis qui optio ad",
                author: "Tess Denesik",
                date: "2020-09-02 15:17:19",
                inventory: 200
            },
            {
                bookName: "Quia tempore molestias sed hic pariatur",
                author: "Arlie Beatty",
                date: "2020-03-28 06:36:59",
                inventory: 400
            }
        ];

        function createTab(name) {
            name.forEach(function (ele) {
                var tr = $('<tr>')
                tr.html("<td>" + ele.bookName + "</td><td>" + ele.author + "</td><td>" + ele.date + "</td><td>" + ele.inventory + "</td>")
                $('tbody').append(tr)
            })
        }
        createTab(books)

        //根据输入存量 判断在其以下的并输出
        $('.search').click(function () {
            var invenTory = $('input').val()
            if (!isNaN(Number(invenTory))) {
                var newArr = books.filter(function (ele) {
                    return ele.inventory >= invenTory
                })
                if (newArr.length) {
                    $('tbody').empty()
                    createTab(newArr)
                } else {
                    $('input').val('')
                    alert('没有查询到内容')
                }
            } else {
                $('input').val('')
                alert('输入有误,重新输入')
            }

        })

        //按照name搜索书籍
        //查看所有包含用户输入的书籍名称
        //查询的结果中 匹配的文字变红 将匹配的字符串替换成<span>匹配的文字</span>
        $('.search-name').click(function () {
            var searchName = $('.name').val()

            if (searchName.trim()) {
                var re = new RegExp(searchName, 'g')
                var newArr = books.filter(function (el) {
                    return el.bookName.includes(searchName)
                })
                $('tbody').empty()
                if (newArr.length) {
                   var arr =  newArr.map(function (ele) {
                        ele.bookName = ele.bookName.replaceAll(re, function (str) {
                            return `<span>${str}</span>`
                        })
                        return ele
                    })
                    createTab(arr)
                } else {
                    alert('没有查询到内容')
                }
            } else {
                $('tbody').empty()
                createTab(books)
            }


        })
    </script>
</body>

</html>